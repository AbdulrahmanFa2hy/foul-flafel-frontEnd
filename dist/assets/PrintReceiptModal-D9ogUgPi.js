import{u as N,b as v,r as w,j as e,F as k,a3 as P,l as d,a4 as R,y,V as i}from"./index-CoZFZ6e7.js";function F({order:t,onClose:l}){const{t:s,i18n:f}=N(),r=f.language==="ar",{user:m}=v(a=>a.auth),[n,c]=w.useState(!1),x=()=>{var o;let a=[];return t.paymentMethods&&t.paymentMethods.length>0?a=t.paymentMethods:t.isPaid&&(a=[{method:"cash",amount:t.totalPrice||t.total||0}]),{...t,orderNumber:t.orderCode||((o=t._id)==null?void 0:o.slice(-8))||"N/A",cashier:(m==null?void 0:m.name)||"System",paymentMethods:a,tax:t.tax||0,discount:t.discount||0,finalTotal:t.totalPrice||t.total||0,orderItems:t.orderItems||[],orderItemsData:t.orderItemsData||[],custName:t.custName||"",custPhone:t.custPhone||t.custtPhone||"",custAddress:t.custAddress||""}},b=async()=>{c(!0);try{const a=x();await y.printCustomerReceipt(a),i.success(s("payment.customerReceiptPrinted"),{icon:"üñ®Ô∏è"}),l()}catch(a){console.error("Customer receipt printing failed:",a),i.error(s("payment.customerReceiptFailed"))}finally{c(!1)}},g=async()=>{c(!0);try{const a=x();await y.printKitchenTicket(a),i.success(s("payment.kitchenTicketPrinted"),{icon:"üñ®Ô∏è"}),l()}catch(a){console.error("Kitchen ticket printing failed:",a),i.error(s("payment.kitchenTicketFailed"))}finally{c(!1)}},j=async()=>{c(!0);try{const a=x(),o=await y.printBothReceipts(a),p=o.filter(h=>h.success).length,u=o.filter(h=>!h.success).length;p>0&&u===0?i.success(s("payment.bothReceiptsPrinted"),{icon:"üñ®Ô∏è"}):p>0&&u>0?i.success(`${p} ${s("payment.someReceiptsFailed")} ${u}`,{icon:"‚ö†Ô∏è"}):i.error(s("payment.printFailed")),l()}catch(a){console.error("Printing failed:",a),i.error(s("payment.printFailed"))}finally{c(!1)}};return e.jsx("div",{className:"fixed left-0 -top-14 w-full h-[120%] inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-md w-full",dir:r?"rtl":"ltr",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:`flex justify-between items-center mb-6 ${r?"flex-row-reverse":""}`,children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:s("payment.printReceipt")}),e.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 transition-colors",disabled:n,children:e.jsx(k,{size:20})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:b,disabled:n,className:"w-full flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsxs("div",{className:`flex items-center ${r?"flex-row-reverse":""}`,children:[e.jsx(P,{className:`text-blue-500 ${r?"ml-3":"mr-3"}`,size:20}),e.jsxs("div",{className:`${r?"text-right":"text-left"}`,children:[e.jsx("div",{className:"font-medium text-gray-800",children:s("payment.customerReceipt")}),e.jsx("div",{className:"text-sm text-gray-500",children:s("payment.customerReceiptDesc")})]})]}),e.jsx(d,{className:"text-gray-400"})]}),e.jsxs("button",{onClick:g,disabled:n,className:"w-full flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-orange-50 hover:border-orange-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsxs("div",{className:`flex items-center ${r?"flex-row-reverse":""}`,children:[e.jsx(R,{className:`text-orange-500 ${r?"ml-3":"mr-3"}`,size:20}),e.jsxs("div",{className:`${r?"text-right":"text-left"}`,children:[e.jsx("div",{className:"font-medium text-gray-800",children:s("payment.kitchenTicket")}),e.jsx("div",{className:"text-sm text-gray-500",children:s("payment.kitchenTicketDesc")})]})]}),e.jsx(d,{className:"text-gray-400"})]}),e.jsxs("button",{onClick:j,disabled:n,className:"w-full flex items-center justify-between p-4 bg-primary-50 border border-primary-200 rounded-lg hover:bg-primary-100 hover:border-primary-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsxs("div",{className:`flex items-center ${r?"flex-row-reverse":""}`,children:[e.jsx(d,{className:`text-primary-600 ${r?"ml-3":"mr-3"}`,size:20}),e.jsxs("div",{className:`${r?"text-right":"text-left"}`,children:[e.jsx("div",{className:"font-medium text-primary-800",children:s("payment.printBoth")}),e.jsx("div",{className:"text-sm text-primary-600",children:s("payment.printBothDesc")})]})]}),e.jsx(d,{className:"text-primary-400"})]})]}),n&&e.jsxs("div",{className:"mt-4 flex items-center justify-center py-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary-700 mr-3"}),e.jsx("span",{className:"text-gray-600",children:s("payment.printing")})]}),e.jsx("div",{className:"mt-6 pt-4 border-t",children:e.jsx("button",{onClick:l,disabled:n,className:"w-full py-2 px-4 text-gray-600 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:s("common.cancel")})})]})})})}export{F as default};
